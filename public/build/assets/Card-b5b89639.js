import{f as d,K as h,u as r,o as _,c as b,b as i,t as y,l as x,m as c,v as u,d as k,i as D,T as S,_ as T}from"./app-40f6085e.js";const w={key:0,class:"modal"},C={class:"glass container card-container"},E={class:"modal-header"},V={class:"title"},L={class:"modal-content"},U={class:"flex-1"},A={class:"form-input pt-5 pb-2.5"},B=i("label",{for:"link"},"Link (Will try to fill the empty fields)",-1),M={class:"form-input pt-5 pb-2.5"},W=i("label",{for:"title"},"Title",-1),q={class:"form-input form-textarea pt-5"},F=i("label",{for:"description"},"Description",-1),I={class:"form-file pt-2.5"},K={for:"cover"},N=["src"],R={class:"flex-1"},j={class:"flex flex-col h-full gap-3"},$={class:"form-textarea form-todo flex-1"},H=i("label",{for:"todo",class:"leading-5"},"Todo:",-1),O=i("div",null,[i("button",{type:"submit",class:"button w-full"},"Save")],-1);let a=d(),f=d(),n=d(),P=d();d();const g=d(),z=h(),G={name:"cardModal",setup(){return{data:a,title:f}},methods:{open(t){const o={link:t.link,title:t.title,cover:t.cover,position:t.position,progress:t.progress,todo:t.todo,description:t.description,column_id:t.column_id};t.id&&(o._method="PUT"),z.props.columns,n=S(o),a.value=t,f.value=t.title,setTimeout(()=>g.value.focus(),100)},close(){a.value=null},submit(){let t="/cards/";n.todo=document.getElementById("todo").value,a.value.id&&(t+=a.value.id),n.post(t,{forceFormData:!0,onError:o=>{P.value=o.msg},onSuccess:()=>{T.show("Card saved successfully","success"),this.close()}})},image(t){v(t.target.files)},changeLink(t){const o=t.target.value;(o.startsWith("http://")||o.startsWith("https://"))&&axios("/geturldata",{params:{url:o}}).then(function(s){const e=document.createElement("html");e.innerHTML=s.data,n.title||(n.title=p(e,"title")),n.description||(n.description=p(e,"description")),n.cover||(n.cover=p(e,"image"))})}}};function p(t,o){let s;return o==="title"&&(s=t.querySelector("title").innerText),o==="description"&&(s=t.querySelector('meta[name="description"]').getAttribute("content")),s||(s=t.querySelector('meta[name="twitter:'+o+'"]').getAttribute("content")),s||(s=t.querySelector('meta[property="og:image"]').getAttribute("content")),s}function m(t){const o=t.target;t.keyCode===9&&(o.setRangeText("	",o.selectionStart,o.selectionStart,"end"),t.preventDefault())}function v(t){const o=t[0];if(o&&(o.type==="image/png"||o.type==="image/jpeg")){n.cover=o;const s=new FileReader;s.readAsDataURL(o),s.onload=()=>{document.getElementById("cover").previousSibling.src=s.result}}}function J(t){return"/getimage?url="+t}window.addEventListener("paste",t=>{if(a.value){const o=t.clipboardData.getData("text");if(o.startsWith("http://")||o.startsWith("https://")){const s=J(o);axios(s).then(function(e){e.data&&(n.cover=s)})}else t.clipboardData.files&&v(t.clipboardData.files)}});const X=Object.assign(G,{setup(t){const o=`Example:
- An undone task
+ Finished group
  + Finished item
`;return(s,e)=>r(a)?(_(),b("div",w,[i("div",C,[i("div",E,[i("a",{class:"btn-close",onClick:e[0]||(e[0]=l=>s.close())}),i("h4",V,y(r(f)),1)]),i("div",L,[i("form",{class:"form flex gap-5",onSubmit:e[10]||(e[10]=x((...l)=>s.submit&&s.submit(...l),["prevent"]))},[i("div",U,[i("div",A,[c(i("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=l=>r(n).link=l),id:"link",placeholder:"Link",onChange:e[2]||(e[2]=l=>s.changeLink(l))},null,544),[[u,r(n).link]]),B]),i("div",M,[c(i("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=l=>r(n).title=l),id:"title",placeholder:"Title",ref_key:"focus",ref:g},null,512),[[u,r(n).title]]),W]),i("div",q,[c(i("textarea",{type:"text","onUpdate:modelValue":e[4]||(e[4]=l=>r(n).description=l),id:"description",placeholder:"Description",onKeydown:e[5]||(e[5]=l=>m(l))},null,544),[[u,r(n).description]]),F]),i("div",I,[i("label",K,[k(" Cover (Click or Ctrl+V to change) "),i("img",{src:r(n).cover},null,8,N),i("input",{type:"file",id:"cover",onInput:e[6]||(e[6]=l=>r(n).cover=l.target.files[0]),onChange:e[7]||(e[7]=l=>s.image(l))},null,32)])])]),i("div",R,[i("div",j,[i("div",$,[H,c(i("textarea",{"onUpdate:modelValue":e[8]||(e[8]=l=>r(n).todo=l),id:"todo",placeholder:o,onKeydown:e[9]||(e[9]=l=>m(l))},null,544),[[u,r(n).todo]])]),O])])],32)])])])):D("",!0)}});export{X as default};
